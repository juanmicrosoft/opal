---
title: "Adding Calor to Existing Projects"
section: "guides"
order: 1
---

# Adding Calor to an Existing C# Project

This guide walks you through adding Calor to an existing C# project, from enabling Calor to building with mixed Calor/C# code.

---

## Overview

Adding Calor to an existing project is a gradual process:

1. **Initialize** - Enable Calor with MSBuild integration
2. **Analyze** - Find files that benefit most from Calor's features
3. **Write/Convert** - Create new files in Calor, convert high-scoring C# files
4. **Build** - Calor compiles automatically with your project

You don't need to convert everything at once. Calor and C# coexist seamlessly.

---

## Step 1: Enable Calor in Your Project

Enable Calor with MSBuild integration:

```bash
# Initialize Calor in your project
calor init

# Or specify a specific project file
calor init --project MyApp.csproj
```

Your `.csproj` is updated with MSBuild targets that compile `.calr` files automatically during `dotnet build`.

---

## Step 2: Analyze Your Codebase

Use `calor analyze` to find C# files that would benefit most from Calor:

```bash
# Analyze your source directory
calor analyze ./src

# Show top 10 candidates with detailed scores
calor analyze ./src --top 10 --verbose
```

### Understanding the Output

```
=== Calor Migration Analysis ===

Analyzed: 42 files
Average Score: 34.2/100

Top 10 Files for Migration:
--------------------------------------------------------------------------------
 82/100 [Critical]  src/Services/PaymentProcessor.cs
 78/100 [Critical]  src/Services/OrderService.cs
 65/100 [High]      src/Repositories/UserRepository.cs
```

| Priority | Score | Recommendation |
|:---------|:------|:---------------|
| **Critical** | 76-100 | Convert to Calor - high benefit |
| **High** | 51-75 | Good conversion candidate |
| **Medium** | 26-50 | Optional - some benefit |
| **Low** | 0-25 | Keep in C# - minimal benefit |

---

## Step 3: Add Your First Calor File

Create a new `.calr` file alongside your existing code:

```calor
§M[m001:Calculator]

§F[f001:Add:pub]
  §I[i32:a]
  §I[i32:b]
  §O[i32]
  §R (+ a b)
§/F[f001]

§/M[m001]
```

---

## Step 4: Build and Verify

```bash
# Build your project - Calor compiles automatically
dotnet build
```

The build process:

1. Finds all `.calr` files in your project
2. Compiles each to `.g.cs` in the `obj/calor/` directory
3. Includes generated C# in the normal compilation

---

## Step 5: Convert High-Scoring C# Files

Based on your analysis results, convert files that score High or Critical:

```bash
# Convert a single file
calor convert src/Services/PaymentProcessor.cs

# With benchmark comparison
calor convert src/Services/PaymentProcessor.cs --benchmark
```

For bulk conversion:

```bash
calor migrate ./src --dry-run  # Preview first
calor migrate ./src            # Execute
```

---

## Optional: Enable Claude Code Integration

For AI-assisted Calor development:

```bash
calor init --ai claude
```

This adds:
- `/calor` and `/calor-convert` skills
- `CLAUDE.md` with guidelines instructing Claude to write new code in Calor and analyze C# files before modifying them

### Using Claude Code

**Write new Calor code:**
```
/calor

Write a function that validates email addresses with:
- Precondition: input is not null or empty
- Postcondition: returns true only for valid emails
```

**Convert existing C# to Calor:**
```
/calor-convert src/Services/PaymentProcessor.cs
```

---

## Best Practices

### What to Convert First

1. **High-scoring files** from `calor analyze`
2. **Files with complex validation** - benefit from contracts
3. **Files with error handling** - benefit from `Result\<T,E\>`
4. **Files with side effects** - benefit from effect declarations

### What to Keep in C#

- Simple DTOs and record types
- Auto-generated code (EF migrations, gRPC stubs)
- Code using features Calor doesn't support yet

---

## Next Steps

- [Syntax Reference](/syntax-reference/) - Complete Calor language reference
- [Contracts](/syntax-reference/contracts/) - Writing preconditions and postconditions
- [Effects](/syntax-reference/effects/) - Declaring side effects
- [calor analyze](/cli/analyze/) - Understanding migration scores
