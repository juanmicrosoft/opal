---
title: "init"
section: "cli"
order: 2
---

# opalc init

Initialize OPAL development environment with MSBuild integration and optional AI agent support.

```bash
opalc init [options]
```

---

## Overview

The `init` command sets up your project for OPAL development by:

1. **Adding MSBuild targets** - Integrates OPAL compilation into your .NET build process
2. **Configuring AI agent integration** (optional) - Creates skills/prompts for your preferred AI coding assistant

After running `init`, you can write `.opal` files alongside your `.cs` files and they'll compile automatically during `dotnet build`.

---

## Quick Start

```bash
# Basic initialization (MSBuild integration only)
opalc init

# Initialize with Claude Code support
opalc init --ai claude

# Initialize with a specific .csproj
opalc init --project MyApp.csproj
```

---

## Options

| Option | Short | Required | Description |
|:-------|:------|:---------|:------------|
| `--ai` | `-a` | No | AI agent to configure: `claude`, `codex`, `gemini`, `github` |
| `--project` | `-p` | No | Target .csproj file (auto-detects if single .csproj exists) |
| `--force` | `-f` | No | Overwrite existing files without prompting |

---

## AI Agent Support (Optional)

When you specify `--ai`, the command also sets up AI-specific configuration files.

### Claude (`--ai claude`)

Creates the following files:

| File | Purpose |
|:-----|:--------|
| `.claude/skills/opal.md` | OPAL code writing skill - teaches Claude OPAL v2+ syntax |
| `.claude/skills/opal-convert.md` | C# to OPAL conversion skill |
| `.claude/settings.json` | **Hook configuration** - enforces OPAL-first development |
| `CLAUDE.md` | Project guidelines instructing Claude to prefer OPAL for new code |

#### OPAL-First Enforcement

The `.claude/settings.json` file configures a `PreToolUse` hook that **blocks Claude from creating `.cs` files**. When Claude tries to write a C# file, it will see:

```
BLOCKED: Cannot create C# file 'MyClass.cs'

This is an OPAL-first project. Create an .opal file instead:
  MyClass.opal

Use /opal skill for OPAL syntax help.
```

Claude will then automatically retry with an `.opal` file. This enforcement ensures all new code is written in OPAL.

**Allowed file types:**
- `.opal` files (always allowed)
- `.g.cs` generated files (build output)
- Files in `obj/` directory (build artifacts)

After initialization, use these Claude Code commands:

| Command | Description |
|:--------|:------------|
| `/opal` | Write new OPAL code with Claude's assistance |
| `/opal-convert` | Convert existing C# code to OPAL syntax |

### Codex (`--ai codex`)

Creates the following files:

| File | Purpose |
|:-----|:--------|
| `.codex/skills/opal/SKILL.md` | OPAL code writing skill with YAML frontmatter |
| `.codex/skills/opal-convert/SKILL.md` | C# to OPAL conversion skill |
| `AGENTS.md` | Project documentation with OPAL-first guidelines |

#### Guidance-Based Enforcement

**Important:** Codex CLI does not support hooks like Claude Code. OPAL-first development is **guidance-based only**.

This means:
- Codex *should* create `.opal` files based on the instructions
- Enforcement is not automatic - review file extensions after generation
- Use `opalc analyze` to find any unconverted `.cs` files

After initialization, use these Codex commands:

| Command | Description |
|:--------|:------------|
| `$opal` | Write new OPAL code with Codex's assistance |
| `$opal-convert` | Convert existing C# code to OPAL syntax |

### Gemini (`--ai gemini`)

Creates the following files:

| File | Purpose |
|:-----|:--------|
| `.gemini/skills/opal/SKILL.md` | OPAL code writing skill with YAML frontmatter |
| `.gemini/skills/opal-convert/SKILL.md` | C# to OPAL conversion skill |
| `.gemini/settings.json` | **Hook configuration** - enforces OPAL-first development |
| `GEMINI.md` | Project guidelines instructing Gemini to prefer OPAL for new code |

#### OPAL-First Enforcement

Like Claude Code, **Gemini CLI supports hooks** (as of v0.26.0+). The `.gemini/settings.json` file configures a `BeforeTool` hook that **blocks Gemini from creating `.cs` files**.

Gemini will receive a JSON response blocking the operation and suggesting an `.opal` file instead. This enforcement ensures all new code is written in OPAL.

**Allowed file types:**
- `.opal` files (always allowed)
- `.g.cs` generated files (build output)
- Files in `obj/` directory (build artifacts)

After initialization, use these Gemini CLI commands:

| Command | Description |
|:--------|:------------|
| `@opal` | Write new OPAL code with Gemini's assistance |
| `@opal-convert` | Convert existing C# code to OPAL syntax |

---

## MSBuild Integration

The `init` command adds MSBuild targets to your `.csproj` file that:

- Compile `.opal` files before C# compilation
- Include generated `.g.cs` files in the build
- Clean generated files on `dotnet clean`

### Output Location

Generated C# files are placed in:

```
obj/<Configuration>/<TargetFramework>/opal/
```

This keeps generated files out of your source tree.

---

## Examples

### Basic Initialization

```bash
# Initialize OPAL (MSBuild only)
opalc init

# Analyze codebase for migration candidates
opalc analyze ./src --top 10
```

### With Claude Code

```bash
# Add Claude Code support
opalc init --ai claude
```

### Initialize New Project

```bash
dotnet new console -o MyOpalApp
cd MyOpalApp
opalc init
opalc init --ai claude  # Optional
```

---

## See Also

- [Adding OPAL to Existing Projects](/guides/adding-opal-to-existing-projects/) - Complete migration guide
- [opalc convert](/cli/convert/) - Convert individual files
- [opalc analyze](/cli/analyze/) - Find migration candidates
- [Claude Integration](/getting-started/claude-integration/) - Using OPAL with Claude Code
- [Codex Integration](/getting-started/codex-integration/) - Using OPAL with OpenAI Codex CLI
- [Gemini Integration](/getting-started/gemini-integration/) - Using OPAL with Google Gemini CLI
